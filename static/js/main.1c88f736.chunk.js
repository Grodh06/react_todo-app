(this["webpackJsonpreact_add-todo-form"]=this["webpackJsonpreact_add-todo-form"]||[]).push([[0],{22:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var c=n(14),r=n.n(c),a=n(6),o=n(0),s=n.n(o),i=n(2),l=n(11),u=n(7),d=n(3),j=n(5),f=n.n(j);var b="https://mate.academy/students-api",p=function(){var e=Object(u.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(b).concat(t));case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("".concat(n.status," - ").concat(n.statusText));case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(u.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(b,"/todos"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t)});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(u.a)(f.a.mark((function e(t,n){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(b,"/todos/").concat(t),{method:"PATCH",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(n)});case 2:return c=e.sent,e.abrupt("return",c.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=Object(u.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(b,"/todos/").concat(t),{method:"DELETE"});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=s.a.createContext("local"),x=n(4),g=n(1),y=function(e){var t=e.storage,n=e.setStorage,c=new URL(document.URL).pathname.includes("server")?"server":void 0,r=Object(x.b)();return Object(g.jsx)("div",{className:"select",children:Object(g.jsxs)("select",{value:t,onChange:function(e){r.push("".concat(e.target.value)),n(e.target.value)},children:[Object(g.jsx)("option",{value:"local",selected:!c,children:"Local"}),Object(g.jsx)("option",{value:"server",selected:"server"===c,children:"Server"})]})})},w=function(e){var t=e.addTodo,n=Object(o.useState)(""),c=Object(d.a)(n,2),r=c[0],a=c[1];return Object(g.jsx)("form",{onSubmit:function(e){e.preventDefault(),r.trim().length>0&&(t(r),a(""))},children:Object(g.jsx)("input",{type:"text","data-cy":"createTodo",className:"new-todo",placeholder:"What needs to be done?",value:r,onChange:function(e){return a(e.target.value)}})})},N=n(9),S=n.n(N),k=n(13),E=n(15);function T(e,t){var n=new URLSearchParams(e.toString());return Object.entries(t).forEach((function(e){var t=Object(d.a)(e,2),c=t[0],r=t[1];null===r?n.delete(c):Array.isArray(r)?(n.delete(c),r.forEach((function(e){n.append(c,e)}))):n.set(c,r)})),n.toString()}var C=["children","params"],L=function(e){var t=e.children,n=e.params,c=Object(E.a)(e,C),r=Object(a.c)(),o=Object(d.a)(r,1)[0];return Object(g.jsx)(a.b,Object(k.a)(Object(k.a)({to:{search:T(o,n)}},c),{},{children:t}))},I=function(){var e=Object(a.c)(),t=Object(d.a)(e,1)[0].get("completed");return Object(g.jsxs)("ul",{className:"filters",children:[Object(g.jsx)("li",{children:Object(g.jsx)(L,{params:{completed:null},className:S()({selected:!t}),children:"All"})}),Object(g.jsx)("li",{children:Object(g.jsx)(L,{params:{completed:"active"},className:S()({selected:"active"===t}),children:"Active"})}),Object(g.jsx)("li",{children:Object(g.jsx)(L,{params:{completed:"completed"},className:S()({selected:"completed"===t}),children:"Completed"})})]})},A=function(e){var t=e.todo,n=e.updateTodo,c=e.clear,r=Object(o.useState)(t.title),a=Object(d.a)(r,2),s=a[0],i=a[1],l=Object(o.useState)(s),u=Object(d.a)(l,2),j=u[0],f=u[1],b=Object(o.useState)(!1),p=Object(d.a)(b,2),h=p[0],O=p[1],m=function(){0===s.trim().length?c(t.id):(f(s),n(t.id,s))};return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("li",{className:S()({completed:t.completed,editing:h}),id:"test",children:[Object(g.jsxs)("div",{className:"view",children:[Object(g.jsx)("input",{type:"checkbox",className:"toggle",id:"toggle-view",checked:t.completed,onChange:function(){n(t.id,!t.completed)}}),Object(g.jsx)("label",{onDoubleClick:function(){return O(!h)},children:j}),Object(g.jsx)("button",{"aria-label":"#toggle-view",type:"button",className:"destroy","data-cy":"deleteTodo",onClick:function(){return c(t.id)}})]}),Object(g.jsx)("input",{type:"text",className:"edit",value:s,onChange:function(e){return i(e.target.value)},onKeyDown:function(e){return"Enter"===(t=e.key)&&(m(),O(!1)),void("Escape"===t&&(i(j),O(!1)));var t},onBlur:function(e){e.preventDefault(),m()}})]})})},J=function(e){var t=e.visibleTodos,n=e.updateTodo,c=e.clear;return Object(g.jsx)("ul",{className:"todo-list","data-cy":"todoList",children:t.map((function(e){return Object(g.jsx)(A,{todo:e,updateTodo:n,clear:c},e.id)}))})},D=function(){var e=new URL(document.URL).pathname.includes("server")?"server":void 0,t=Object(o.useState)(e||"local"),n=Object(d.a)(t,2),c=n[0],r=n[1],s=function(e,t){var n=Object(o.useState)((function(){if(void 0===typeof window)return t;try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(c){return t}})),c=Object(d.a)(n,2),r=c[0],a=c[1];return[r,function(t){var n=t instanceof Function?t(r):t;a(n),"undefined"!==typeof window&&window.localStorage.setItem(e,JSON.stringify(t))}]}("todos",[]),i=Object(d.a)(s,2),j=i[0],b=i[1],x=Object(o.useState)([]),N=Object(d.a)(x,2),S=N[0],k=N[1],E=Object(a.c)(),T=Object(d.a)(E,1)[0].get("completed"),C=function(){var e=Object(u.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p("/todos").then(k);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){var e=setInterval(C,500);return function(){return clearInterval(e)}}),[]),Object(o.useEffect)((function(){C()}),[]);var L="local"===c?j:S,A=Object(l.a)(L).filter((function(e){switch(T){case"active":return!1===e.completed;case"completed":return!0===e.completed;default:return!0}})),D=function(e){"local"===c?function(e){b(e?j.filter((function(t){return t.id!==e})):j.filter((function(e){return!0!==e.completed})))}(e):e?m(e):L.filter((function(e){return!0===e.completed})).forEach((function(e){return m(e.id)}))},P=function(e,t){var n=j.find((function(t){return t.id===e}));n&&("boolean"===typeof t?n.completed=t:n.title=t,b(j.map((function(t){return t.id===e?n:t}))))},R=function(){"local"===c?j.every((function(e){return!0===e.completed}))?j.forEach((function(e){return P(e.id,!1)})):j.forEach((function(e){return P(e.id,!0)})):L.every((function(e){return!0===e.completed}))?L.forEach((function(e){return O(e.id,{completed:!1})})):L.forEach((function(e){return O(e.id,{completed:!0})}))};return Object(g.jsxs)(v.Provider,{value:"",children:[Object(g.jsx)(y,{storage:c,setStorage:r}),Object(g.jsxs)("div",{className:"todoapp",children:[Object(g.jsxs)("header",{className:"header",children:[Object(g.jsx)("h1",{children:"".concat(c," todos")}),Object(g.jsx)(w,{addTodo:function(e){return"local"===c?function(e){var t={userId:1,title:e,id:j.length>0?Math.max.apply(Math,Object(l.a)(j.map((function(e){return e.id}))))+1:1,completed:!1};b([t].concat(Object(l.a)(j)))}(e):h({userId:1,title:e,completed:!1})}})]}),Object(g.jsxs)("section",{className:"main",children:[Object(g.jsx)("input",{type:"checkbox",id:"toggle-all",className:"toggle-all","data-cy":"toggleAll",onChange:function(){R()}}),Object(g.jsx)("label",{htmlFor:"toggle-all",children:"Mark all as complete"}),Object(g.jsx)(J,{visibleTodos:A,updateTodo:function(e,t){"local"===c?P(e,t):O(e,"string"===typeof t?{title:t}:{completed:t})},clear:D})]}),0!==L.length&&Object(g.jsxs)("footer",{className:"footer",children:[Object(g.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:L.length}),Object(g.jsx)(I,{}),Object(g.jsx)("button",{type:"button",className:"clear-completed",onClick:function(){D()},children:"Clear completed"})]})]})]})},P=function(){return Object(g.jsxs)(i.d,{children:[Object(g.jsxs)(i.b,{path:"/",children:[Object(g.jsx)(i.b,{index:!0,element:Object(g.jsx)(D,{})}),Object(g.jsx)(i.b,{path:"local",element:Object(g.jsx)(D,{})}),Object(g.jsx)(i.b,{path:"server",element:Object(g.jsx)(D,{})})]}),Object(g.jsx)(i.b,{path:"home",element:Object(g.jsx)(i.a,{to:"/"})}),Object(g.jsx)(i.b,{path:"*",element:Object(g.jsx)("p",{children:"Page not found"})})]})};n(22),n(23),n(24);r.a.render(Object(g.jsx)(a.a,{children:Object(g.jsx)(P,{})}),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.1c88f736.chunk.js.map